webpackJsonp([20],{"/EfR":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("//Fk"),r=a.n(n),o=a("ZSmk"),i=a("0xDb"),s={name:"singleUpload",props:{value:String},computed:{imageUrl:function(){return this.value},imageName:function(){return null!=this.value&&""!==this.value?this.value.substr(this.value.lastIndexOf("/")+1):null},fileList:function(){return[{name:this.imageName,url:this.imageUrl}]},showFileList:{get:function(){return null!==this.value&&""!==this.value&&void 0!==this.value},set:function(t){}}},data:function(){return{dataObj:{policy:"",signature:"",key:"",ossaccessKeyId:"",dir:"",host:""},dialogVisible:!1}},methods:{emitInput:function(t){this.$emit("input",t)},handleRemove:function(t,e){this.emitInput("")},handlePreview:function(t){this.dialogVisible=!0},beforeUpload:function(t){var e=this;return new r.a(function(t,a){Object(o.a)().then(function(a){console.log("响应的数据",a),e.dataObj.policy=a.data.policy,e.dataObj.signature=a.data.signature,e.dataObj.ossaccessKeyId=a.data.accessId,e.dataObj.key=a.data.dir+Object(i.b)()+"_${filename}",e.dataObj.dir=a.data.dir,e.dataObj.host=a.data.host,console.log("响应的数据222。。。",e.dataObj),t(!0)}).catch(function(t){a(!1)})})},handleUploadSuccess:function(t,e){console.log("上传成功..."),this.showFileList=!0,this.fileList.pop(),this.fileList.push({name:e.name,url:this.dataObj.host+"/"+this.dataObj.key.replace("${filename}",e.name)}),console.log(this.fileList[0].url),this.emitInput(this.fileList[0].url)}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{attrs:{action:"http://yjxiao.oss-cn-shanghai.aliyuncs.com",data:t.dataObj,"list-type":"picture",multiple:!1,"show-file-list":t.showFileList,"file-list":t.fileList,"before-upload":t.beforeUpload,"on-remove":t.handleRemove,"on-success":t.handleUploadSuccess,"on-preview":t.handlePreview}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过10MB")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.fileList[0].url,alt:""}})])],1)},staticRenderFns:[]};var d={components:{SingleUpload:a("VU/8")(s,l,!1,function(t){a("q2lO")},null,null).exports},data:function(){return{visible:!1,dataForm:{brandId:0,name:"",logo:"",descript:"",showStatus:1,firstLetter:"",sort:0},dataRule:{name:[{required:!0,message:"品牌名不能为空",trigger:"blur"}],logo:[{required:!0,message:"品牌logo地址不能为空",trigger:"blur"}],descript:[{required:!0,message:"介绍不能为空",trigger:"blur"}],showStatus:[{required:!0,message:"显示状态[0-不显示；1-显示]不能为空",trigger:"blur"}],firstLetter:[{validator:function(t,e,a){""==e?a(new Error("首字母必须填写")):/^[a-zA-Z]$/.test(e)?a():a(new Error("首字母必须a-z或者A-Z之间"))},trigger:"blur"}],sort:[{validator:function(t,e,a){""===e?a(new Error("排序字段必须填写")):/^[0-9]$/.test(e)?a():a(new Error("排序必须是一个大于等于0的整数"))},trigger:"blur"}]}}},methods:{init:function(t){var e=this;this.dataForm.brandId=t||0,this.visible=!0,this.$nextTick(function(){e.$refs.dataForm.resetFields(),e.dataForm.brandId&&e.$http({url:e.$http.adornUrl("/product/brand/info/"+e.dataForm.brandId),method:"get",params:e.$http.adornParams()}).then(function(t){var a=t.data;a&&0===a.code&&(e.dataForm.name=a.brand.name,e.dataForm.logo=a.brand.logo,e.dataForm.descript=a.brand.descript,e.dataForm.showStatus=a.brand.showStatus,e.dataForm.firstLetter=a.brand.firstLetter,e.dataForm.sort=a.brand.sort)})})},dataFormSubmit:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&t.$http({url:t.$http.adornUrl("/product/brand/"+(t.dataForm.brandId?"update":"save")),method:"post",data:t.$http.adornData({brandId:t.dataForm.brandId||void 0,name:t.dataForm.name,logo:t.dataForm.logo,descript:t.dataForm.descript,showStatus:t.dataForm.showStatus,firstLetter:t.dataForm.firstLetter,sort:t.dataForm.sort})}).then(function(e){var a=e.data;a&&0===a.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}}):t.$message.error(a.msg)})})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"140px"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.dataFormSubmit()}}},[a("el-form-item",{attrs:{label:"品牌名",prop:"name"}},[a("el-input",{attrs:{placeholder:"品牌名"},model:{value:t.dataForm.name,callback:function(e){t.$set(t.dataForm,"name",e)},expression:"dataForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"品牌logo地址",prop:"logo"}},[a("single-upload",{model:{value:t.dataForm.logo,callback:function(e){t.$set(t.dataForm,"logo",e)},expression:"dataForm.logo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"介绍",prop:"descript"}},[a("el-input",{attrs:{placeholder:"介绍"},model:{value:t.dataForm.descript,callback:function(e){t.$set(t.dataForm,"descript",e)},expression:"dataForm.descript"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"显示状态",prop:"showStatus"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},model:{value:t.dataForm.showStatus,callback:function(e){t.$set(t.dataForm,"showStatus",e)},expression:"dataForm.showStatus"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"检索首字母",prop:"firstLetter"}},[a("el-input",{attrs:{placeholder:"检索首字母"},model:{value:t.dataForm.firstLetter,callback:function(e){t.$set(t.dataForm,"firstLetter",e)},expression:"dataForm.firstLetter"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{attrs:{placeholder:"排序"},model:{value:t.dataForm.sort,callback:function(e){t.$set(t.dataForm,"sort",t._n(e))},expression:"dataForm.sort"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dataFormSubmit()}}},[t._v("确定")])],1)],1)},staticRenderFns:[]},c=a("VU/8")(d,u,!1,null,null,null);e.default=c.exports},jvGr:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},q2lO:function(t,e,a){var n=a("jvGr");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("3fad3ee4",n,!0)}});